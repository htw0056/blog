# 大家来学vim摘要

### 第一章 进来先看看

#### 1. Vim的基本模式(basic mode)可有六种:

1. **常态模式(Normal mode)**  
   您一进入 vim 就是处于这常态模式,只能下按键指令,不能输入编辑文字。这些指令可能是游标移动的指令,也可能是编辑指令或寻找替换指令。

2. **插入模式(Insert mode)**
   按 i 就会进入插入模式,此时才可以键入文字,写您的文章,按 Esc 又会回到正常模式。此时在状态栏会有 INSERT 字样。

3. **命令行模式(Cmdline mode or Command-line mode)**  

   按冒号:(别忘了 Shift 键)就会进入命令行模式,左下角会有一个冒号:出现可下ex6指令。也 是按 Esc 回命令行模式。反正正常状态都是处于常态模式,这样才不会把您辛苦打字的文章给 随便搞乱掉。搜寻时的 / 及 ? 按键也是属于命令行模式。  

4. 反白模式(Visual mode)

   这就是把需要处理的文字反白起来,等待处理的模式,底部状态最会有 VISUAL 或 VISUAL LINE 或 VISUAL BLOCK 字样。

5. 选择模式(Select mode) 

   和反白模式的异同待了解。

6. Ex 模式(Ex mode) 

   这和命令行模式是一样的,但下了命令后不会返回,会留在行编辑器 ex 的状态,有一个冒号在那儿,等待输入命令。由 gQ按键可以进入 Ex模式,输入visual可以返回正常模式。


### 第二章 光标的移动


#### 1. 基本的光标移动


| 命令     | 作用                             |
| ------ | ------------------------------ |
| h      | 左,或 Backspace 或箭头键。            |
| j      | 下,或 Enter 或 +(要 Shift 键),或箭头键。 |
| k      | 上,或 箭头键或 –(不必 Shift 键)。        |
| l      | 右,或 Space 或箭头键。                |
| Ctrl+f | 即 PageDown 翻页(Forward,向前、下翻页)。 |
| Crtl+b | 即 PageUp 翻页(Backward,向后、上翻页)。  |


1. **Backspace 及 Space 的移动方式是到了行首或行尾时会折行,但箭头键或 hl 键的移动则在行 首或行尾时您继续按也不会折行。**  
2. **jk 及使用箭头键的上下移动光标会尽量保持在同一字段。使用 Enter,+,–的上下移动,光标 会移至上(下)一行的第一个非空格符处。**


#### 2. 进阶的光标移动


| 命令   | 作用                                       |
| ---- | ---------------------------------------- |
| 0    | 是数目字 0 而不是英文字母 o。或是 Hmoe 键,移至行首,(含空格符)。  |
| ˆ    | 移至行首第一个非空格符,注意,要 Shift 键。                |
| $    | 移至行尾,或 End 键。要 Shift 键。                  |
| G    | 移至档尾(全文最后一行的第一个非空格符处)                    |
| gg   | 移至档首(全文第一行之第一个非空格符处)。在规则表示式 (regularexpression)中,ˆ是匹配行首,$是匹配行尾。gg是Vim的扩充功能,在elvis或原始vi中可用1G来移至文件首(是数字1不是英文字l)。 |
| G    | 之原意是 goto,指移至指定数目行之行首,如不指定数目,则预设是最后一行。   |
| w    | 移至次一个字(word)前缀。当然是指英文单字。 W 同上,但会忽略一些标点符号。 |
| e    | 移至后一个字字尾。                                |
| E    | 同上,但会忽略一些标点符号。                           |
| b    | 移至前一个字前缀。                                |
| B    | 同上,但会忽略一些标点符号。                           |
| H    | 移至屏幕顶第一个非空格符。                            |
| M    | 移至屏幕中间第一个非空格符。                           |
| L    | 移至屏幕底第一个非空格符。                            |
| n\|  | 移至第 n 个字符(栏)处。注意,要用 Shift 键。n 是从头起算的。    |
| :n   | 移至第 n 行行首。或 nG。 2.3 特殊的移动                |


#### 3.特殊的移动

| 命令   | 作用                                       |
| ---- | ---------------------------------------- |
| )    | 移至下一个句子(sentence)首。                      |
| (    | 移至上一个句子(sentence)首。sentence(句子)是以 . ! ? 为区格。 |
| }    | 移至下一个段落(paragraph)首。                     |
| {    | 移至上一个段落(paragraph)首。paragraph(段落)是以空白行为区格。 |
| %    | 这是匹配{},[],()用的,例如光标在{上只要按%,就会跑到相匹配的}上。   |



### 第三章 基本编辑指令

#### 1. 进入插入模式的指令

| 命令   | 作用                                      |
| ---- | --------------------------------------- |
| i    | 在光标所在字符前开始输入文字(insert)。                 |
| a    | 在光标所在字符后开始输入文字(append)。                 |
| o    | 在光标所在行下开一新行来输入文字(open)。                 |
| I    | 在行首开始输入文字。                              |
| A    | 在行尾开始输入文字。                              |
| O    | 在光标所在行上开一新行来输入文字。                       |
| J    | 将下一行整行接至本行(Joint),留下一个空格。使用`gJ`，可以不留空格。 |

#### 2. 删除指令

| 命令   | 作用                                       |
| ---- | ---------------------------------------- |
| x    | 删除光标所在处之字符,在中文指一个中文字。在 Vim 及 elvis 亦可用 Del 键。 |
| X    | 删除光标前之字符。不可使用 Backspace 键,除非是在插入模式。      |
| dd   | 删除一整行(delete line)。                      |
| dw   | 删除一个字(delete word)。不能适用于中文。              |
| dG   | 删至档尾。                                    |
| d1G  | 删至档首。或 dgg(只能用于 Vim)。                    |
| D    | 删至行尾,或 d$(含光标所在处字符)。                     |
| d0   | 删至行首,或 dˆ(不含光标所在处字符)。                    |

#### 3. 取代及还原

| 命令     | 作用                                |
| ------ | --------------------------------- |
| r      | 取代光标所在处之字符。                       |
| R      | 进入取代模式(replace mode),取代字符至按Esc为止。 |
| cc     | 取代整行内容。或大写 S 亦可。                  |
| cw     | 替换一个英文字(word),中文不适用。(change)      |
| ~      | 光标所在处字符之大小写互换。当然不能用于中文。别忘了 Shift! |
| C      | 取代至行尾,即光标所在处以后的字都会被替换。或 c$。       |
| c0     | 取代至行首,或 cˆ。                       |
| s      | 替换一个字符为您所输入的字符串。                  |
| u      | 这个太重要了,就是 undo。                   |
| U      | 在光标没离开本行之前,恢复所有编辑动作。              |
| Crtl+r | 这个也是很重要,就是 redo 键。                |

#### 4. 加上数目字

| 命令         | 作用                                  |
| ---------- | ----------------------------------- |
| 5dd        | 删除游标所在处(含)起算以下五行内容。妙吧!              |
| 3r         | 按了 3r 后,您键入一个英文字,则三个字符皆会被您所键入的英文取代。 |
| 5J         | 将五行合并成一行。                           |
| 3x         | 删除三个字符。                             |
| 5i A       | 然后按 Esc,插入五个A。                      |
| 2i sys Esc | 插入 syssys。                          |
| 5G         | 光标移至第五行,是从档首开始起算。和 :5 作用相同。         |
| 5l         | 移至右第五个字符处,当然 j 是可以用箭头键取代的。          |


#### 5. 简单重排功能

| 命令                | 作用                                  |
| ----------------- | ----------------------------------- |
| »                 | 整行向右移一个 shiftwidth(预设是 8 个字符,可重设)。  |
| «                 | 整行向左移一个 shiftwidth( 预设是 8 个字元,可重设)。 |
| :set shiftwidth?  | 可得知目前的设定值。                          |
| :set shiftwidth=4 | 可马上重设为 4 个字符。shiftwidth 可简写成 sw。    |
| :ce(nter)         | 本行文字置中。注意是冒号命令!                     |
| :ri(ght)          | 本行文字靠右。                             |
| :le(ft)           | 本行文字靠左。                             |
| gqap              | 整段重排,或 gqip,在段落中位何地方都可以使用。          |
| gqq               | 本行重排。                               |
| gqQ               | 全文重排,是以光标所在处的段落开始重排至档尾。以空白行为段落的间隔。  |


| 命令    | 作用       |
| ----- | -------- |
| gq3q  | 重排三行     |
| gq2ap | 重排两个段落   |
| gq5j  | 重排光标以下五行 |
| gq}   | ohter    |
| gq)   | other    |


### 第四章 复制(yank)

| 命令    | 作用                                       |
| ----- | ---------------------------------------- |
| yy    | 复制游标所在行整行。或大写一个 Y。                       |
| 2yy   | 复制两行,y2y 也可以。ㄟ,请举一反三好不好!:-)              |
| yˆ    | 复制至行首,或 y0。不含光标所在处字符。                    |
| y$    | 复制至行尾。含光标所在处字符。                          |
| yw    | 复制一个 word。                               |
| y2w   | 复制两个字。                                   |
| yG    | 复制至档尾。                                   |
| y1G   | 复制至档首。                                   |
| p     | 小写 p 代表贴至光标后(下)。                         |
| P     | 大写 P 代表贴至光标前(上)。整行的复制,按p贴在下(上)一行。非整行的复制则是贴在游标所在处之后(前)。 |
| :reg  | 列出所有registers的代号及内容。                     |
| "ayy  | 将本行文字复制到a缓冲区。a 可为 26 个英文字母中的一个,如果是小写的话,原先的内容会被清掉,如果是大写的话是 append 的作用,会把内容附加到原先内容之后。 |
| "ap   | 将a缓冲区的内容贴上。                              |
| 5"ayy | 复制五行内容至 a 缓冲区。                           |
| 5"Ayy | 再复制五行附在 a 内容之后,现在 a 中有十行内容了              |



### 第五章 搜寻、替换

#### 1. 搜寻

| 命令   | 作用                                       |
| ---- | ---------------------------------------- |
| /    | 在c-mode 的情形下,按/就会在左下方出现一个/,然后键入您要寻找的字符 串, 按个 Enter 就会开始找。? 和 / 相同,只是 / 是向前(下)找, ? 则是向后 (上) 找。 |
| n    | 继续寻找。                                    |
| N    | 继续寻找(反向)。                                |


#### 2. 更方便的搜寻操作(Vim 才有)

| 命令   | 作用                           |
| ---- | ---------------------------- |
| *    | 寻找游标所在处之 word(要完全符合)。        |
| \#   | 同上,但\*是向前(下)找,# 则是向后(上)找。    |
| g*   | 同 * ,但部份符合即可。                |
| g#   | 同 # ,但部份符合即可。n, N 之继续寻找键仍适用。 |

#### 3. 替换(substitute)

**:[range]s/pattern/string/[c,e,g,i]**

| 命令      | 作用                                       |
| ------- | ---------------------------------------- |
| range   | 指的是范围,1,7 指从第一行至第七行, 1,$ 指从第一行至最后一行,也就是整篇文章,也可以 % 代表。% 是目前编辑的文章,# 是前一次编辑的文章。 |
| pattern | 就是要被替换掉的字符串,可以用 regexp 来表示。              |
| c       | confirm,每次替换前会询问。                        |
| e       | 不显示 error。                               |
| g       | globe,不询问,整行替换。                          |
| i       | ignore 不分大小写。                            |


#### 4. 书签功能

| 命令     | 作用                                       |
| ------ | ---------------------------------------- |
| mx     | x 代表 26 个小写英文字母,这样光标所在处就会被 mark。         |
| \`x    | 回到书签原设定位置。\`是 backward quote,就是 Tab 键上面那一个。 |
| 'x     | 回到书签设定行行首。'是 forward quote,是 Enter 键隔壁那一个。 |
| :marks | 得知目前所有书签的列表。                             |

### 第六章 叫档、存档、紧急回复

#### 1. 开档的一些花招

| 命令              | 作用                                 |
| --------------- | ---------------------------------- |
| vim + 文件名       | 这样开文件后,游标会落在档案最后一行的行尾。             |
| vim +n文件名       | 开文件后,游标会落在第n行的行首。                  |
| vim +/string 檔名 | /就是寻找指令,这样进入档案后光标就会落在第一个找到的string上 |

#### 2. 多档编辑

| 命令           | 作用                                       |
| ------------ | ---------------------------------------- |
| :n           | 编辑下一个档案。                                 |
| :2n          | 编辑下二个档案。                                 |
| :N           | 编辑前一个档案。注意,这种用法只能用于 argument list 的情形。   |
| :e 檔名        | 这是在进入 vim 后,在不离开 vim 的情形下再开其它档案。只要您要 编辑的档案是在目前目录,Tab 补全键还是可以使用。 |
| :e# 或 Ctrl+ˆ | 编辑前一个档案,用于两档互相编辑时相当好用。这种用法不管是argument list或buffer list档案间皆可使用。还记得吗?#代表的是前一次编辑的档案。 |
| :e#编号        | 编辑:ls显示的编号文件                             |
| :files       | 或 :buffers 或 :ls,会列出目前 buffer 中的所有档案。在 elvis 中 可使用 :b 来叫出 buffers。在 buffers 中,减号 –表示这个 buffer 并 未载入,不过,不必担心,载入相当快速的。加号 + 表示这个 buffer 已经修改过了。# 代表前一次编辑的档案,% 是目前编辑中的档案,这 两个代号应该很熟悉了吧! |
| :bn          | buffer next。编辑次一个 buffer 的档案。            |
| :bp          | buffer previous。编辑前一个 buffer 的档案。        |
| :bl          | buffer last。编辑 buffer 中最后一个档案。           |
| :b 档名或编号     | 移至该档。                                    |
| :bd(elete)   | buffer 在未离开 vim 前是不会移除的,可使用这个指令移除。       |
| :e! 檔名       | 这样也是会开檔,但会放弃目前编辑档案的改变,否则如果档案已有变 动,vim 预设是不让您随便离开的。:e! 后不接什么的话,代表舍弃一 切修改,重载编辑中档案。 |
| :f 或 Ctrl+g  | 显示目前编辑的文件名、是否经过修改及目前光标所在之位置。             |
| :f 檔名        | 改变编辑中的档名。(file)                          |
| :r 文件名       | 在游标所在处插入一个档案内容。(read)                    |
| :35 r 檔名     | 将档案插入至 35 行之后。                           |
| gf           | 这是 vim 的特殊叫档法,会叫出游标所在处的 word 为名的档案,当 然,这个档案要在目前目录内,否则会开新档案。 |

#### 3. 离开

| 命令   | 作用                           |
| ---- | ---------------------------- |
| :q   | 如本文有修改而没存盘,会警告,且无法离开。(quit)  |
| :q!  | 舍弃所有修改,强迫离开。                 |
| :wq  | 存档后离开。纵使档案未曾修改也是会再存一次档。      |
| :x   | 也是存盘后离开,但如果档案没有修改,则不会做存盘的动作。 |
| ZZ   | 和 :x 完全一样,随您高兴用哪一个。          |
| :w檔名 | 另存他檔。不加档名就是写入原档。(write)      |


#### 4. vim的加密功能
| 命令          | 作用                       |
| ----------- | ------------------------ |
| vim -x [檔名] | 加密，进入 vim 编辑档案中,可用 :X 指令 |


#### 5. 紧急恢复

| 命令       | 作用                       |
| -------- | ------------------------ |
| vim -r档名 | 或进入vim后,下:recover档名,来恢复。 |


### 第七章 各种标示方法及窗口操作


#### 1. 标示指令

| 命令      | 作用                                       |
| ------- | ---------------------------------------- |
| v       | 小写 v,这是属于字符标示(character visual),按下v后您就可以移动光标,光标走过的地方就会标示起来。再按一次v或按Esc键就会结束v-mode。 |
| V       | 大写V,这是行标示(line visual),按下 V后会整行标示起来(包括行首前 空白的部分),您移动上下键,会标示多行。 |
| Ctrl+v  | 这是区块标示(blockwise visual),可纵向标示矩形区域。      |
| d       | 删除标示区内容。                                 |
| y       | 复制标示区内容。                                 |
| c       | 替换标示区内容。                                 |
| ~       | 标示区内容大小写互换。                              |
| gq      | 重排标示区内容。请注意,这是要先标示好才按的。"ay 还能不能用呢?当然可以,这样就会把标示区内容存于 a 缓冲区中。可以用 "ap 来贴上。 |
| Shift+> | 标示区内容向右移一个 Tab。                          |
| Shift+< | 标示区内容向左移一个 Tab。                          |

#### 2. 窗口操作

| 命令       | 作用                                       |
| -------- | ---------------------------------------- |
| Ctrl+w n | 即 :new。开一空的新窗口。这在 Vim 会开在原窗口上半方,也就是窗口一分为二。 |
| Ctrl+w s | 即:sp(lit),会开一新窗口,且原文件分属两个窗口。             |
| Ctrl+w f | 开一新窗口,并编辑光标所在处之 word 为档名的档案。             |
| Ctrl+w q | 即 :q 结束分割出来的窗口。                          |
| Ctrl+w o | 即:only! 使光标所在之窗口,成为目前唯一显示的窗口其它窗口会隐藏起来。   |
| Ctrl+w j | 移至下窗口。                                   |
| Ctrl+w k | 移至上窗口。还记得 hjkl 的按键移动方式吗?                 |
| :sp 文件名  | 开另一新窗口来编辑档案。                             |


### 第八章 shell 命令及求助系统




#### 1. shell 命令

| 命令             | 作用                                       |
| -------------- | ---------------------------------------- |
| :!外部指令         | 执行外部指令。当然您的指令要在$PATH环境变量内。               |
| :!!            | 执行前一次执行之外部指令。在这里的!可不是强迫中止喔!              |
| @:             | 这是Vim的一个很特殊的指令,可以重复前一次的冒号命令。             |
| :sh(ell)       | 执行 shell。使用exit回到vim。console 或 xterm 下的 vim 当然就是跳出 vim 进入 shell 中。至于是用哪一种 shell 是可以另外设定的, 可由:set shell=来设定。 |
| :r !commond    | 这个就妙了!会在光标所在处次一行插入外部指令 commond 执行后 的输出内容。例如:r !date就会插入日期时间 |
| :n,mw !commond | 以 n 至 m 行内之数据,当做外部指令 commond 的 input。这算是相 当高级的用法了,初学者大概还用不上,不过印象中留有一个这 样的功 能,以后总是会用得上的。 |
| K              | 大写 K 会显示光标所在处之 word 的 man page 系统在线使用手册。 |


### 第十章 规则表示式的运用


#### 1. 基本的匹配

| 命令        | 作用                                       |
| --------- | ---------------------------------------- |
| *         | 指前所绑住的字符或字符集合,出现 0次或0次以上。                |
| \\+       | 和*作用相同,但不包括出现 0次。                        |
| \\=       | 指前所绑住的字符恰好出现0或1次。                        |
| \\\|      | 这是多选,就是 or 的意思,被 \| 隔开的 pattern,任一个符合的话就算符合。 |
| [...]     | 字符集合,表示中括号中所有字符中的其中一个。                   |
| [ˆ..]     | 这是上述[...]的补集,表非中括号内字符的其中一个。              |
| .         | 除换行字符外的任一单一字符。指本身,非指前所绑之字符。              |
| ˆ         | 匹配行首,指其后绑住的字符串,出现在行首才符合。                 |
| $         | 匹配行尾,指其前绑住的字符串,出现在行尾才符合。含换行字符。不 是在行首的ˆ指的是ˆ这个字符。不是在行尾的$是指$本身这个字符。 |
| \\(...\\) | 记忆pattern,可由\1,\2...\9来叫出。               |
| \\\<      | 匹配字(word)首。所谓word包括文数字及底线。               |
| \\\>      | 匹配字尾。这就是前所提及的限定用法,被\<,或\>括住的pattern就会被限制住,使regexp 不能再向右(左)扩充解释。 |
| \\{n,m}   | 指前所绑住的字符或字符集合最少出现 n 次,最多出现 m 次。          |


#### 2. 中介字符

| 命令   | 作用                                       |
| ---- | ---------------------------------------- |
| \\s  | 表空格符,即Space或Tab。                         |
| \\S  | 表非空格符。                                   |
| \\d  | 表数目字(digits),即 [0–9]。                    |
| \\D  | 表非数目字,即 [ˆ0–9]。                          |
| \\w  | 表一般字符(word character),包括底线。即[0–9a–zA–Z]。 |
| \\W  | 表非一般字符,即 [ˆ0–9a–zA–Z_]。                  |
| \\a  | 表英文字母(alphabetic character),即 [a–zA–Z]。  |
| \\A  | 表非英文字母,即 [ˆa–zA–Z]。                      |
| \\l  | 表小写字母(lowercase character),即[a–z]。       |
| \\L  | 表非小写字母,即 [ˆa–z]。                         |
| \\u  | 表大写字母(uppercase),即 [A–Z]。                |
| \\U  | 表非大写字母,即 [ˆA–Z]。                         |

### 第十一章 把 Vim 折迭(folding)


#### 1. 折迭的产生

| 命令       | 作用                   |
| -------- | -------------------- |
| zfap     | 将游标所在处的那个段落折迭成一行。    |
| zf7G     | 自光标所在处至全文第 7 行折迭起来。  |
| :3,9fold | 将第 3 行至第 9 行折迭起来。    |
| 5zF      | 将光标所在处起算 5 行的内容折迭起来。 |


#### 2. 折迭的操作

| 命令 | 作用                                                         |
| ---- | ------------------------------------------------------------ |
| zo   | 将游标所在处的折迭打开。open。                               |
| zc   | 将光标所在处已打开的内容再度折迭起来。close。                |
| zr   | 将全文的所有折迭依层次通通打开。reduce。                     |
| zm   | 将全文已打开的折迭依层次通通再折迭起来。more。               |
| zR   | 作用和 zr 同,但会打开含巢状折迭(折迭中又还有折迭)的所有折迭。 |
| zM   | 作用和 zm 同,但对于巢状折迭亦有作用。                        |
| zi   | 这是个切换,是折迭与不折迭指令间的切换。                      |
| zn   | 打开全文的所有折迭。fold none。                              |
| zN   | 这是 zn 的相对指令,恢复所有的折迭。                          |

