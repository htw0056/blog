# sed

sed全称stream editor，因此它实际上就是一个编辑器。和vim不同的是，它并不交互式的编辑器。



### 简介

```
sed [选项]  [定址commands] [inputfile]
```

##### 选项

选项|作用
---|---
-n|使用安静(silent)模式。在一般sed的用法中,所有来自STDIN的数据一般都会被列出到屏幕上。但如果加上-n参数后,则只有经过sed特殊处理的那一行(或者动作)才会被列处理
-e|直接在指令列模式上进行sed的动作编辑
-f|直接将sed的动作写在一个档案内,-f filename则可以执行filename内的sed动作
-i|直接修改读取文档案内容,而不是由屏幕输出
-r|扩展正则

##### 定址

定址|作用
---|---
0个|处理全文
1个|行号或者正则，处理文件所在行
2个|行号或者正则，处理文件所在行之间的内容

##### commands

commands|作用
---|---
a|新增，a的后面可以接字符串，而这些字符串会在新的一行出现(目前的下一行)
i|插入，i的后面可以接字符串，而这些字符串会在新的一行出现(目前的上一行)
s|取代,可以直接进行取代的工作!通常这个 s 的动作可以搭配正则表达式
d|删除，因为是删除，所以后面通常不接任何东西
c|取代，c的后面可以接字符串，可以将指定行取代为特定的字符串
p|打印
y|转换，转换命令会将inchars和outchars的值进行一对一映射





### commands


##### d

```
#删除第2行到第5行
nl /etc/passwd |sed  '2,5d'
#删除第2行
nl /etc/passwd |sed  '2d'
#删除第2行到最后一行
nl /etc/passwd |sed  '2,$d'
#来点高级的,使用文本模式匹配过滤器,也就是将数字部分用正则来替换使用
nl /etc/passwd |sed '/root/d'
nl /etc/passwd|sed '/root/,/nobody/d'
```

##### a(i)

```
#在第二行后添加一行
nl /etc/passwd|sed '2a aaa'
#在第二行后添加多行，注意必须使用\
nl /etc/passwd|sed '2a aaa\
bbb\
ccc'
```

##### c

```
#替换第二行到第五行
nl /etc/passwd|sed '2,5c no 2-5 number'
```


##### p

```
#打印第二行到第五行,注意-n的使用
nl /etc/passwd|sed -n '2,5p'
```


##### s

**相当重要的一个命令！**  

```
s/parrern/replacement/flags  
```

flags|作用
---|---
数字|表明新文本将替换第几处模式匹配的地方
g|表明新文本将会替换所有原来已有文本出现的地方
p|表明原来行的内容要打印出来
w file|将替换的结果写到文件中



### 更多案例


##### 多个命令使用


```
sed -e 's/dog/cat/; s/test/Test/' data1
```

or

```
sed -e 's/dog/cat/' -e 's/test/Test/' data1
```

or

```
sed -e '
s/brown/green/
s/fox/elephant/' data1
```


or

```
cat script.txt

s/brown/green/
s/fox/elephant/

#######
sed -f script.txt data1
```

##### 组合命令

```
#组合在一起的命令作用在同一个范围内的文本
#而上面的多个命令使用，不同命令可以选定不同范围的文本，这两者略有区别
sed '2,${
> s/brown/green/
> s/lazy/active/
> }' data1
```


### sed中的正则表达式

这里不介绍正则表达式的语法规则，只介绍正则在sed中的一些写法(正如我们所知，正则表达式在linux系统的各个工具中存在一些写法上的不同)。

字符|描述
---|---
^	|匹配一行的起始
$	|匹配一行的结尾
.	|匹配任何的单个字符
*	|匹配零个或多个以前出现的字符
[chars]	|为了匹配任何字符串的字符。您可以使用`-`字符来表示字符的范围。



集|描述
---|---
[a-z]|匹配一个小写字母
[A-Z]|匹配一个大写字母
[a-zA-Z]|匹配一个字母
[0-9]|匹配数字
[a-zA-Z0-9]|匹配单个字母或数字


字符类|描述
---|---
[[:alnum:]]|字母(a - z A-Z 0 - 9)
[[:alpha:]]	|字母(a - z A-Z)
[[:blank:]]	|空白字符(空格或制表键)
[[:cntrl:]]	|控制字符
[[:digit:]]	|数字[0 - 9]
[[:graph:]]	|任何可见字符(不包括空格)
[[:lower:]]	|小写字母的[a -ž]
[[:print:]]	|可打印字符(无控字符)
[[:punct:]]	|标点字符
[[:space:]]	|空白
[[:upper:]]	|大写字母的[A -Z]
[[:xdigit:]]|	十六进制数字[0 - 9 a - f A-F]


在sed中一些符号的写法前需加上斜杠(\\):  

```
{     ->    \{
}     ->    \}
(	  ->    \(
)     ->    \)
```
