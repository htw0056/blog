# 非对称密码

## 1. DH算法(密钥交换)

### DH算法数学原理

假如用户A和用户B希望交换一个密钥。

取素数p和整数a，a是p的一个原根，公开a和p。

A选择随机数XA<p，并计算YA=a^XA mod p。

B选择随机数XB<p，并计算YB=a^XB mod p。

每一方都将X保密而将Y公开让另一方得到。

A计算密钥的方式是：K=(YB) ^XA mod p

B计算密钥的方式是：K=(YA) ^XB mod p

**证明：**

```
(YB)^ XA mod p = (a^XB mod p)^ XA mod p
= (a^XB)^ XA mod p = (a^XA) ^XB mod p  (<-- 密钥即为 a^(XA*XB) mod p)
= (a^XA modp)^ XB mod p= (YA) ^XB mod p
```



由于XA和XB是保密的，而第三方只有*p*、*a*、YB、YA可以利用，只有通过取离散对数来确定密钥，但对于大的素数*p*，计算离散对数是十分困难的。





## 2. RSA算法

### RSA算法数学原理

1. 加解密公式

   - RSA加密：密文=明文^E % N 公钥(E,N)
   - RSA解密：明文=密文^D % N 私钥(D,N)

2. 模拟生成密钥对

   1. 求N: p=17,q=19----N=p*q=323
   2. 求L: L=lcm(p-1,q-1)=lcm(16,18)=144
   3. 求E: gcd(E,L)=1----E=5
   4. 求D: E*D % L =1----D=29
   5. 公钥(5,323),私钥(29,323)

3. 加密

   密文=明文^E % N =123^5 % 323 =225

4. 解密

   明文=密文^D % N = 225^29 % 323 =123




